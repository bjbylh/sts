{% include "./top.html" %}
<link href="/static/metronic/assets/global/plugins/bootstrap-datepicker/css/bootstrap-datepicker3.min.css" rel="stylesheet" type="text/css" />
<link href="/static/metronic/assets/global/plugins/bootstrap-datetimepicker/css/bootstrap-datetimepicker.min.css" rel="stylesheet" type="text/css" />
<link href="/static/metronic/assets/global/plugins/select2/css/select2.min.css" rel="stylesheet" type="text/css" />
<link href="/static/metronic/assets/global/plugins/select2/css/select2-bootstrap.min.css" rel="stylesheet" type="text/css" />
<!-- END PAGE LEVEL PLUGINS -->
<!-- BEGIN THEME GLOBAL STYLES -->
<link href="/static/metronic/assets/global/css/components.min.css" rel="stylesheet" id="style_components" type="text/css" />
<link href="/static/metronic/assets/global/css/plugins.min.css" rel="stylesheet" type="text/css" />
<!-- END THEME GLOBAL STYLES -->

<script src="/static/metronic/assets/global/plugins/select2/js/select2.full.min.js" type="text/javascript"></script>

<script src="/static/metronic/assets/global/plugins/jquery-validation/js/jquery.validate.min.js" type="text/javascript"></script>
<script src="/static/metronic/assets/global/plugins/jquery-validation/js/additional-methods.min.js" type="text/javascript"></script>

<script src="/static/metronic/assets/global/plugins/jquery-validation/js/localization/messages_zh.min.js" type="text/javascript"></script>

<script src="/static/metronic/assets/global/scripts/app.min.js" type="text/javascript"></script>

<!-- BEGIN PAGE LEVEL SCRIPTS -->
<script src="/static/metronic/assets/pages/scripts/components-select2.min.js" type="text/javascript"></script>
<!-- END PAGE LEVEL SCRIPTS -->
<script src="\static\metronic\assets\global\plugins\bootstrap-datetimepicker\js\bootstrap-datetimepicker.min.js" type="text/javascript"></script>
<script src="\static\metronic\assets\global\plugins\bootstrap-datetimepicker\js\locales\bootstrap-datetimepicker.zh-CN.js" type="text/javascript"></script>
<script src="/static/metronic/assets/global/plugins/bootstrap-datepicker/js/bootstrap-datepicker.min.js" type="text/javascript"></script>
<script src="/static/metronic/assets/global/plugins/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js" type="text/javascript"></script>
<script src="/static/metronic/assets/pages/scripts/components-date-time-pickers.js" type="text/javascript"></script>
<div class="col-md-12">
	<!-- BEGIN EXAMPLE TABLE PORTLET-->
	<div class="portlet light " style="margin-bottom: 0px;padding-bottom: 0px;">
		<div class="portlet-title">
			<div class="caption font-dark">
				<i class="icon-settings font-dark"></i>
				<span class="caption-subject bold uppercase">{{sat.name}}<i class="fa fa-chevron-right"></i>
                   <span id="subsyspath">{{data.subsys_name}}分系统</span><i class="fa fa-chevron-right"></i> {% if data._id==null %}添加单机{% else %}编辑单机{% endif %}</span>
			</div>
			<div class="tools"></div>
		</div>
		<div class="portlet-body form" style="padding-top: 8px !important;">
			<input type="hidden" id="_satcode" value="{{sat.code}}">
			<input type="hidden" id="subsys_id" name="subsys_id" value="{{data.subsys}}">
			<input type="hidden" id="_hproduct" value="{{data.product}}" />
			<input type="hidden" id="_hspectrum" value="{{data.spectrum}}" />
			<form class="form-horizontal" id="form_satellite">
				<div class="form-body" style="padding: 0px !important;">
					<input type="hidden" id="_id" name="_id" value="{{data._id}}">
					<input type="hidden" id="_satid" name="_satid" value="{{sat._id}}">
					<input type="hidden" id="subsys" name="subsys" value="{{data.subsys}}" style="z-index:-1000">
					<div class="alert alert-danger display-hide">
						<button class="close" data-close="alert"></button> 表单验证失败，请检查表单内容.
					</div>
					<div class="row">
						<div class="col-xs-6">
							<div class="form-group">
								<label class="control-label col-xs-4" for="subsyscode">分系统代号</label>
								<div class="col-xs-8">
									<input class="form-control" id="subsyscode" name="subsyscode" value="{{data.subsyscode}}" readonly>
								</div>
							</div>
						</div>
						<div class="col-xs-6">
							<div class="form-group">
								<label class="control-label col-xs-4" for="subsys_name">分系统名称</label>
								<div class="col-xs-8">
									<input class="form-control" id="subsys_name" name="subsys_name" value="{{data.subsys_name}}" readonly>
								</div>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-xs-6">
							<div class="form-group">
								<label class="control-label col-xs-4" for="name">单机名称 <span> * </span></label>
								<div class="col-xs-8">
									<input class="form-control" type="text" id="name" name="name" value="{{data.name}}">
								</div>
							</div>
						</div>
						<div class="col-xs-6">
							<div class="form-group">
								<label class="control-label col-xs-4" for="code">单机代号 <span> * </span></label>
								<div class="col-xs-8">
									<input class="form-control" type="text" id="code" name="code" value="{{data.code}}">
								</div>
							</div>
						</div>
					</div>
					<hr>
					<div class="row">
             		    <div class="col-xs-6">
							<div class="form-group">
								<label class="control-label col-xs-4" for="number">数量</label>
								<div class="col-xs-8">
									<input class="form-control" type="text" id="number" name="number" value="{{data.number}}">
								</div>
							</div>
						</div>
						<div class="col-xs-6">
							<div class="form-group">
								<label class="control-label col-xs-4" for="crucial">是否关键单机</label>
								<div class="col-xs-8">
									<select class="form-control" id="crucial" name="crucial" autocomplete="off">
										<option value=0 {% if data.crucial==0 %}selected="selected" {% endif %}>否</option>
										<option value=1 {% if data.crucial==1 %}selected="selected" {% endif %}>是</option>
									</select>
								</div>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-xs-6">
							<div class="form-group">
								<label class="control-label col-xs-4" for="backups">主份/备份</label>
								<div class="col-xs-8">
									<select class="form-control" id="backups" name="backups" autocomplete="off">
										<option value="主份" {% if data.backups=="主份" %}selected="selected" {% endif %}>主份</option>
										<option value="备份" {% if data.backups=="备份" %}selected="selected" {% endif %}>备份</option>
									</select>
								</div>
							</div>
						</div>
						<div class="col-xs-6">
							<div class="form-group">
								<label class="control-label col-xs-4" for="spectrum_1">是否型谱化产品</label>
								<div class="col-xs-8">
									<select class="form-control" id="spectrum_1" name="spectrum_1" autocomplete="off">
										<option value="否" {% if data.spectrum_1=="否" %}selected="selected" {% endif %}>否</option>
										<option value="是" {% if data.spectrum_1=="是" %}selected="selected" {% endif %}> 是</option>
									</select>
								</div>
							</div>
						</div>
					</div>
					<div class="row display">
						<div class="col-xs-6">
							<div class="form-group">
								<label class="control-label col-xs-4" for="product">产品化单机</label>
								<div class="col-xs-8">
									<input class="form-control" type="text" id="product" name="product" value="{{data.product}}">
								</div>
							</div>
						</div>
						<div class="col-xs-6">
							<div class="form-group">
								<label class="control-label col-xs-4" for="spectrum">型谱</label>
								<div class="col-xs-8">
									<input class="form-control" type="text" id="spectrum" name="spectrum" value="{{data.spectrum}}">
								</div>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-xs-6">
							<div class="form-group">
								<label class="control-label col-xs-4" for="startingUp_time">累计开机时间</label>
								<div class="col-xs-8">
									<input class="form-control" type="text" id="startingUp_time" name="startingUp_time" value="{{data.startingUp_time}}">
								</div>
							</div>
						</div>
						<div class="col-xs-6">
							<div class="form-group">
								<label class="control-label col-xs-4" for="startingUp_num">开关机次数</label>
								<div class="col-xs-8">
									<input class="form-control" type="text" id="startingUp_num" name="startingUp_num" value="{{data.startingUp_num}}">
								</div>
							</div>
						</div>
					</div>

					<div class="row">
						<div class="col-xs-6">
							<div class="form-group">
								<label class="control-label col-xs-4" for="fault_time">故障时间</label>
								<div class="col-xs-8">
									<div class="input-group date form_datetime form_datetime bs-datetime">
										<input type="text" size="16" class="form-control" id="fault_time" name="fault_time" value="{{data.fault_time}}">
										<span class="input-group-addon">
										<button class="btn default date-set" type="button">
											<i class="fa fa-calendar"></i>
										</button>
	                                 </span>
									</div>
								</div>
							</div>
						</div>
						<div class="col-xs-6">
							<div class="form-group">
								<label class="control-label col-xs-4" for="lose_time">失效时间</label>
								<div class="col-xs-8">
									<div class="input-group date form_datetime form_datetime bs-datetime">
										<input type="text" size="16" class="form-control" id="lose_time" name="lose_time" value="{{data.lose_time}}">
										<span class="input-group-addon">
										<button class="btn default date-set" type="button">
											<i class="fa fa-calendar"></i>
										</button>
									</span>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-xs-6">
							<div class="form-group">
								<label class="control-label col-xs-4" for="product_state">产品状态</label>
								<div class="col-xs-8">
									<select class="form-control" id="product_state" name="product_state" autocomplete="off">
										<option value="正常" {% if data.product_state=="正常" %}selected="selected" {% endif %}>正常</option>
										<option value="故障" {% if data.product_state=="故障" %}selected="selected" {% endif %}>故障</option>
										<option value="失效" {% if data.product_state=="失效" %}selected="selected" {% endif %}>失效</option>
									</select>
								</div>
							</div>
						</div>
						<div class="col-xs-6">
							<div class="form-group">
								<label class="control-label col-xs-4" for="manufacturers">产品厂家</label>
								<div class="col-xs-8">
									<input type="text" class="form-control" id="manufacturers" name="manufacturers" value="{{data.manufacturers}}">
								</div>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-xs-6">
							<div class="form-group">
								<label class="control-label col-xs-4" for="work_time">累计工作时间</label>
								<div class="col-xs-8">
									<input type="text" class="form-control" id="work_time" name="work_time" value="{{data.work_time}}">
								</div>
							</div>
						</div>

					<div class="col-xs-6">
						<div class="form-group">
							<label class="control-label col-xs-4" for="sources_1">国产/进口</label>
							<div class="col-xs-8">
								<select class="form-control" id="sources_1" name="sources_1" autocomplete="off">
									<option value="国产" {% if data.sources_1=="国产" %}selected="selected" {% endif %}>国产</option>
									<option value="进口" {% if data.sources_1=="进口" %}selected="selected" {% endif %}>进口</option>
								</select>
							</div>
						</div>
					</div>
					</div>
					<div class="row">
						<div class="col-xs-6">
							<div class="form-group">
								<label class="control-label col-xs-4" for="proficiency">成熟度</label>
								<div class="col-xs-8">
									<input class="form-control" type="text" id="proficiency" name="proficiency" value="{{data.proficiency}}">
								</div>
							</div>
						</div>
						<div class="col-xs-6">
							<div class="form-group">
								<label class="control-label col-xs-4" for="worksate_1">交付时工作状态</label>
								<div class="col-xs-8">
									<input class="form-control" type="text" id="worksate_1" name="worksate_1" value="{{data.worksate_1}}">
								</div>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-xs-6">
							<div class="form-group">
								<label class="control-label col-xs-4" for="worksate_2">当前工作状态</label>
								<div class="col-xs-8">
									<input class="form-control" type="text" id="worksate_2" name="worksate_2" value="{{data.worksate_2}}">
								</div>
							</div>
						</div>
						<div class="col-xs-6">
							<div class="form-group">
								<label class="control-label col-xs-4" for="backup">备份方式</label>
								<div class="col-xs-8">
									<input class="form-control" type="text" id="backup" name="backup" value="{{data.backup}}">
								</div>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-xs-6">
							<div class="form-group">
								<label class="control-label col-xs-4" for="product_unit">产品化单机单位</label>
								<div class="col-xs-8">
									<input class="form-control" type="text" id="product_unit" name="product_unit" value="{{data.product_unit}}">
								</div>
							</div>
						</div>
						<div class="col-xs-6">
							<div class="form-group">
								<label class="control-label col-xs-4" for="sources">产地</label>
								<div class="col-xs-8">
									<input class="form-control" type="text" id="sources" name="sources" value="{{data.sources}}">
								</div>
							</div>
						</div>
					</div>

					<div class="row">
						<div class="col-xs-6">
							<div class="form-group">
								<label class="control-label col-xs-4" for="technical">主要技术指标</label>
								<div class="col-xs-8">
									<textarea class="form-control" name="technical" id="technical" rows="3">{{data.technical}}</textarea>
								</div>
							</div>
						</div>
						<div class="col-xs-6">
							<div class="form-group">
								<label class="control-label col-xs-4" for="describe">设备描述</label>
								<div class="col-xs-8">
									<textarea class="form-control" name="describe" id="describe" rows="3">{{data.describe}}</textarea>
								</div>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-xs-6">
							<div class="form-group">
								<label class="control-label col-xs-4" for="remark">备注</label>
								<div class="col-xs-8">
									<textarea class="form-control" name="remark" id="remark" rows="3">{{data.remark}}</textarea>
								</div>
							</div>
						</div>
						<div class="col-xs-6">
							<div class="form-group">
								<label class="control-label col-xs-4" for="batch">设备批次</label>
								<div class="col-xs-8">
									<input type="text" class="form-control" id="batch" name="batch" value="{{data.batch}}">
								</div>
							</div>
						</div>
					</div>
					<div class="form-group col-xs-6">
						<label class="control-label col-xs-4" for="params">关键参数</label>
						<div class="col-xs-8">
							<select class="form-control" id="params" name="params" autocomplete="off">
								<option value="遥测id" {% if data.params.tmid=="遥测id" %}selected="selected" {% endif %}>遥测id</option>
								<option value="遥测代号" {% if data.params.code=="遥测代号" %}selected="selected" {% endif %}>遥测代号</option>
								<option value="遥测名称" {% if data.params.note=="遥测名称" %}selected="selected" {% endif %}>遥测名称</option>
								<option value="剔野上限" {% if data.params.upper=="剔野上限" %}selected="selected" {% endif %}>剔野上限</option>
								<option value="剔野下限" {% if data.params.lower=="剔野下限" %}selected="selected" {% endif %}>剔野下限</option>
								<option value="剔野斜率" {% if data.params.gradient=="剔野斜率" %}selected="selected" {% endif %}>剔野斜率</option>
								<option value="判读最小值" {% if data.params.min=="判读最小值" %}selected="selected" {% endif %}>判读最小值</option>
								<option value="判读最大值" {% if data.params.max=="判读最大值" %}selected="selected" {% endif %}>判读最大值</option>
								<option value="标签" {% if data.params.tag=="标签" %}selected="selected" {% endif %}>标签</option>
							</select>
						</div>
					</div>
				</div>
			</form>
		</div>
	</div>
</div>

<script>
  var callbackdata = function() {
    $('#form_satellite').submit();
    var validate = $('#form_satellite').valid();
    if (validate) {
      return [form2obj('form_satellite')];
    } else {
      return null;
    }
  };

  $(document).ready(function() {
    var rules = {
      name: {
        minlength: 2,
        required: true,
        remote: {
          url: 'doValidateName',
          type: 'post',
          data: {
            'name': function() {
              return $('#name').val();
            },
            'subsysid': function() {
              return $('#_id').val();
            },
            '_satid': function() {
              return $('#_satid').val();
            }
          }
        }
      },
      code: {
        minlength: 2,
        maxlength: 10,
        required: true,
        remote: {
          url: 'doValidateCode',
          type: 'post',
          data: {
            'code': function() {
              return $('#code').val();
            },
            'subsysid': function() {
              return $('#_id').val();
            },
            '_satid': function() {
              return $('#_satid').val();
            }
          }
        }
      }
    };
    var message = {
      code: {remote: '设备代号不合法或已被占用'},
      name: {remote: '设备名称不合法或已被占用'}
    };
    bindFormValidate('#form_satellite', rules, message);
  });

</script>
{% include "./footer.html" %}
